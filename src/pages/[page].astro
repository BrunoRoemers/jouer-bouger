---
import { getCollection, getEntry } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Field from "../components/card/Field.astro";

export async function getStaticPaths() {
  const cards = await getCollection("cards");
  return cards
    .map((card) => card.id)
    .map((slug) => ({ params: { page: slug } }));
}

const { page } = Astro.params;
if (page === undefined) {
  throw new Error("page param not provided");
}

const card = await getEntry("cards", page);
if (card === undefined) {
  throw new Error(`could not find card with id "${page}"`);
}
---

<Layout title={`Jouer Bouger - ${card.id}`}>
  <main>
    <!-- TODO use Astro image -->
    <div class="flex justify-center mt-10 mb-20">
      <img
        class="w-24 text-center"
        src="/public/jouer-bouger-logo.png"
        alt="Jouer Bouger Logo"
      />
    </div>
    <!-- TODO font and styles -->
    <h1 class="text-center font-thin text-xl mb-10">{card.data.title}</h1>
    <Field label="ðŸŒˆ CatÃ©gorie ðŸŒˆ" value={card.data.category} />
    <Field label="ðŸ‘¶ Age ðŸ‘¶" value={card.data.age} />
    <Field label="ðŸ“ Lieu et surface ðŸ“" value={card.data.placeAndSurface} />
    <Field label="âš’ï¸ MatÃ©riel âš’ï¸" value={card.data.materials} />
    <Field label="â²ï¸ DurÃ©e â²ï¸" value={card.data.duration} />
    <Field label="ðŸŽ¯ But du jeu ðŸŽ¯" value={card.data.goal} />
    <Field label="ðŸ† Pour gagner ðŸ†" value={card.data.victory} />
    <Field
      label="ðŸ‘©â€ðŸ‘¦ Variantes Ã  deux ðŸ‘¨â€ðŸ‘§"
      value={card.data.variationTwoPlayers}
    />
    <Field
      label="ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Variantes Ã  plusieurs joueurs ðŸ‘¨â€ðŸ‘§â€ðŸ‘¦"
      value={card.data.variationManyPlayers}
    />
    <!-- TODO render video -->
    <p>render video here: {card.data.videoUrl}</p>
    <!-- TODO insert Tally contact form -->
  </main>
</Layout>
