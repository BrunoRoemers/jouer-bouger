---
import { getCollection, getEntry } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Field from "../components/card/Field.astro";
import Logo from "../components/card/Logo.astro";
import Video from "../components/card/Video.astro";
import TallyForm from "../components/card/TallyForm.astro";

export async function getStaticPaths() {
  const cards = await getCollection("cards");
  return cards
    .map((card) => card.id)
    .map((slug) => ({ params: { card_id: slug } }));
}

const card = await getEntry("cards", Astro.params.card_id);

const title =
  card.data.metadata?.title || `${card.data.title} - ${card.id} - Jouer Bouger`;
const defaultDescription = `Bougez plus avec le jeu "${card.data.title}" de la collection Jouer Bouger.`;
const description = card.data.metadata?.description || defaultDescription;
---

<Layout
  title={title}
  description={description}
  canonicalUrl={`/${card.id}`}
  ogTitle={card.data.metadata?.ogTitle}
  ogDescription={card.data.metadata?.ogDescription}
>
  <main>
    <Logo />
    <h1 class="text-center font-amatic-sc text-3xl md:text-5xl mb-10">
      {card.data.title}
    </h1>
    <Field label="ðŸŒˆ CatÃ©gorie ðŸŒˆ" value={card.data.category} />
    <Field label="ðŸ‘¶ Age ðŸ‘¶" value={card.data.age} />
    <Field label="ðŸ“ Lieu et surface ðŸ“" value={card.data.placeAndSurface} />
    <Field label="âš’ï¸ MatÃ©riel âš’ï¸" value={card.data.materials} />
    <Field label="â²ï¸ DurÃ©e â²ï¸" value={card.data.duration} />
    <Field label="ðŸŽ¯ But du jeu ðŸŽ¯" value={card.data.goal} />
    <Field label="ðŸ† Pour gagner ðŸ†" value={card.data.victory} />
    <Field
      label="ðŸ‘©â€ðŸ‘¦ Variantes Ã  deux ðŸ‘¨â€ðŸ‘§"
      value={card.data.variationTwoPlayers}
    />
    <Field
      label="ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Variantes Ã  plusieurs joueurs ðŸ‘¨â€ðŸ‘§â€ðŸ‘¦"
      value={card.data.variationManyPlayers}
    />
    <div class="overflow-hidden rounded-2xl mb-10">
      <Video url={card.data.videoUrl} />
    </div>
    <div class="mb-10">
      <TallyForm formId="3jlDO9" title="Contact Form" />
    </div>
    <div
      class="text-center text-sm md:text-base text-neutral-400 hover:underline"
    >
      <a href="/liste">DÃ©couvrez tous les jeux!</a>
    </div>
  </main>
</Layout>
