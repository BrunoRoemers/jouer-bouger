---
import { getCollection, getEntry } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Field from "../components/card/Field.astro";
import Logo from "../components/card/Logo.astro";
import Video from "../components/card/Video.astro";
import TallyForm from "../components/card/TallyForm.astro";

export async function getStaticPaths() {
  const cards = await getCollection("cards");
  return cards
    .map((card) => card.id)
    .map((slug) => ({ params: { card_id: slug } }));
}

const { card_id } = Astro.params;
if (card_id === undefined) {
  throw new Error("card_id param not provided");
}

const card = await getEntry("cards", card_id);
if (card === undefined) {
  throw new Error(`could not find card with id "${card_id}"`);
}
---

<Layout title={`${card.data.title} - ${card.id} - Jouer Bouger`}>
  <main>
    <Logo />
    <h1 class="text-center font-amatic-sc text-3xl md:text-5xl mb-10">
      {card.data.title}
    </h1>
    <Field label="🌈 Catégorie 🌈" value={card.data.category} />
    <Field label="👶 Age 👶" value={card.data.age} />
    <Field label="📏 Lieu et surface 📏" value={card.data.placeAndSurface} />
    <Field label="⚒️ Matériel ⚒️" value={card.data.materials} />
    <Field label="⏲️ Durée ⏲️" value={card.data.duration} />
    <Field label="🎯 But du jeu 🎯" value={card.data.goal} />
    <Field label="🏆 Pour gagner 🏆" value={card.data.victory} />
    <Field
      label="👩‍👦 Variantes à deux 👨‍👧"
      value={card.data.variationTwoPlayers}
    />
    <Field
      label="👩‍👧‍👦 Variantes à plusieurs joueurs 👨‍👧‍👦"
      value={card.data.variationManyPlayers}
    />
    <div class="overflow-hidden rounded-2xl mb-10">
      <Video url={card.data.videoUrl} />
    </div>
    <div class="mb-10">
      <TallyForm formId="3jlDO9" title="Contact Form" />
    </div>
    <div
      class="text-center text-sm md:text-base text-neutral-400 hover:underline"
    >
      <a href="/liste">Découvrez tous les jeux!</a>
    </div>
  </main>
</Layout>
